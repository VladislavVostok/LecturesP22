

### Что Такое gRPC и Его Основные Преимущества

**gRPC (Google Remote Procedure Call)** — это современный высокопроизводительный фреймворк для удаленного вызова процедур (RPC), который использует HTTP/2 и Protocol Buffers (protobuf) в качестве механизма сериализации по умолчанию.

Вот его ключевые преимущества, которые делают его идеальным для микросервисов и высоконагруженных систем:

- **Высокая производительность**: Бинарный формат protobuf обеспечивает более высокую скорость сериализации и десериализации по сравнению с текстовыми форматами, такими как JSON, а использование HTTP/2 позволяет multiplexing нескольких запросов в одном соединении.
    
- **Контрактный дизайн (Contract-first)**: API определяется в `.proto`-файлах, что обеспечивает строгую типизацию и независимость от языка реализации. Код клиента и сервера генерируется автоматически.
    
- **Поддержка потоковой передачи**: gRPC поддерживает унарные (одиночные), серверные, клиентские и двунаправленные потоковые вызовы.
    
- **Встроенная интеграция с [ASP.NET](https://asp.net/) Core**: Сервисы имеют полный доступ к таким функциям, как Dependency Injection, аутентификация, авторизация и логирование.


**Пример**


Настройка Сервеара
 
```sh
dotnet new sln -n GrpcExample  
```

```sh
dotnet new grpc -n GrpcServer    
```

```sh
dotnet sln GrpcExample.sln add GrpcServer/GrpcServer.csproj         
```


Настройка Клиента

```sh
dotnet new console -n GrpcClient
```

```sh
dotnet sln GrpcExample.sln add GrpcClient/GrpcClient.csproj    
```

```sh
dotnet add GrpcClient/GrpcClient.csproj package Grpc.Net.Client    
dotnet add GrpcClient/GrpcClient.csproj package Google.Protobuf        
dotnet add GrpcClient/GrpcClient.csproj package Grpc.Tools    
```   

```sh
mkdir GrpcClient/Protos   
```

Создать файл GrpcClient\Protos\greet.proto

```proto
syntax = "proto3";                                                                                                                                                  
option csharp_namespace = "GrpcClient";                                            
package greet;                                                                     

service Greeter {                                                                  
	rpc SayHello (HelloRequest) returns (HelloReply);                              
}                                                                                  

message HelloRequest {                                                             
	string name = 1;                                                               }                                                                                  
	
message HelloReply {                                                               
	string message = 1;                                                            }
```


Добавляем в файл GrpcClient\GrpcClient.csproj  

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net9.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Google.Protobuf" Version="3.32.1" />
    <PackageReference Include="Grpc.Net.Client" Version="2.71.0" />
    <PackageReference Include="Grpc.Tools" Version="2.72.0">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
  </ItemGroup>

<!-- Это добавить  -->
  <ItemGroup>
    <Protobuf Include="Protos\greet.proto" GrpcServices="Client" />
  </ItemGroup>

</Project>
```
```cs
using System.Threading.Tasks;

using Grpc.Net.Client;

using GrpcClient;

  
using var channel = GrpcChannel.ForAddress("https://localhost:7114");

var client = new Greeter.GreeterClient(channel);

var reply = await client.SayHelloAsync(

                  new HelloRequest { Name = "gRPC Client" });

Console.WriteLine("Greeting: " + reply.Message);

Console.WriteLine("Press any key to exit...");

Console.ReadKey();
```


1. **Запустите сервер:**
```sh
cd Server
dotnet run
```

2. **Запустите клиент:**
```sh
cd Client  
dotnet run
```
